!function(t){"use strict";var n=function(n,a,i,o,e){var r=this;a.addClass("nb-list");var s={common:function(t){n.$count=n.$rows.length,n.$total=t,n.$more=n.$count<n.$total,n.$pages=Math.ceil(n.$total/o.limit()),n.$pageMin=1,n.$pageMax=n.$pages,n.$prev=n.$page>n.$pageMin,n.$next=n.$page<n.$pageMax;var a=n.$page-1;a<1&&(a=1);var i=n.$page+1;i>n.$pages&&(i=n.$pages),n.$prevPage=isNaN(a)?1:a,n.$nextPage=isNaN(i)?1:i,n.$pagination=n.$pages>1;for(var e=[],r=o.range(),s=[],l=n.$pageMin,p=n.$pageMax,u=1;u<=n.$pages;u++)e.push(u);n.$paginator=e,r>0&&((l=n.$page-r)<n.$pageMin&&(l=n.$pageMin),(p=n.$page+r)>n.$pageMax&&(p=n.$pageMax));for(u=l;u<=p;u++)s.push(u);n.$range=s,n.$pageMinInRange=n.$range.indexOf(n.$pageMin)>-1,n.$pageMaxInRange=n.$range.indexOf(n.$pageMax)>-1},init:function(a,i){var o=[];t.forEach(a,function(t){o.push(n.mapRow(t))}),n.$rows=o,n.$page=1,s.common(i),n.$init=!0},more:function(i,o){var e=a.parents("md-content"),l=a.height();n.$page>n.$pageMin&&(n.$rows=[]),t.forEach(i,function(t){n.$rows.push(t)}),n.$page=n.$pageMin,s.common(o),r.$timeout(function(){e.first().animate({scrollTop:l-e.offset().top},500)},10)},page:function(a,i,o){var e=[];t.forEach(i,function(t){e.push(t)}),n.$rows=e,n.$page=a+1,s.common(o)}};e(n,function(t){a.prepend(t)}),n.$offset=o.offset(),n.$limit=o.limit(),n.$loading=!0,n.$init=!1,n.$firstLoad=!1,n.$rows=[],n.$paginator=[],s.common(0),n.$nbList={load:function(a){if(t.isArray(n.source))s.init(n.source,n.source.length),n.$loading=!1,n.$firstLoad=!0;else if(t.isFunction(n.source)){n.$loading=!0;var i=n.source.call(n,{offset:a?0:o.offset(),limit:a||o.limit()});t.isArray(i)?(s.init(i,i.length),n.$loading=!1,n.$firstLoad=!0):i&&i.then(function(t){s.init(o.mapRows(t.data),o.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText),s.init([],0)}).finally(function(){n.$loading=!1,n.$firstLoad=!0})}},refresh:function(){n.$page>1?this.page(n.$page):this.load(n.$count)},reset:function(){n.offset=0,n.offset=0,n.$nbList.load()},clear:function(){s.init([],0)},more:function(){n.$loading=!0;var a=o.offset()+o.limit();n.$page>n.$pageMin&&(a=0);var i=n.source.call(n,{offset:a,limit:o.limit()});n.offset=a,n.offset=a,t.isArray(i)?(s.more(i,i.length),n.$loading=!1,n.$firstLoad=!0):i.then(function(t){s.more(o.mapRows(t.data),o.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText),s.more([],0)}).finally(function(){n.$loading=!1,n.$firstLoad=!0})},page:function(a){n.$loading=!0;var i=a-1;i<0?i=0:i>=n.$pages&&(i=n.pages-1);var e=i*o.limit(),r=n.source.call(n,{offset:e,limit:o.limit()});n.offset=e,n.offset=e,t.isArray(r)?(s.page(i,r,r.length),n.$loading=!1,n.$firstLoad=!0):r.then(function(t){s.page(i,o.mapRows(t.data),o.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText),s.page(i,[],0)}).finally(function(){n.$loading=!1,n.$firstLoad=!0})}},!0===n.autostart&&n.$nbList.load()};t.module("nb.list",[]).provider("$nbList",[function(){var t=this,n={limit:10,range:0,paginationTemplate:"",map:{rows:function(t){return t.rows},total:function(t){return t.total}}};t.limit=function(t){return n.limit=t,n.limit},t.range=function(t){return n.range=t,n.range},t.paginationTemplate=function(t){return n.paginationTemplate=t,n.paginationTemplate},t.mapRows=function(t){return n.map.rows=t,n.map.rows},t.mapTotal=function(t){return n.map.total=t,n.map.total},t.$get=[function(){var t=function(){};return t.limit=function(){return n.limit},t.range=function(){return n.range},t.paginationTemplate=function(){return n.paginationTemplate},t.mapRows=function(t){return n.map.rows.call(this,t)},t.mapTotal=function(t){return n.map.total.call(this,t)},t}]}]).directive("nbList",["$nbList","$compile","$templateCache","$q","$http","$timeout","$document","$window",function(a,i,o,e,r,s,l,p){return{restrict:"EA",transclude:!0,scope:{source:"=",offset:"@",limit:"@",range:"@",locals:"=",paginationTemplate:"@",$nbList:"=control",autostart:"@",mapRow:"=?mapRow"},controller:["$scope",function(t){var n=this;n.offset=function(){return 1*(t.offset||0)},n.limit=function(){return 1*(t.limit||a.limit())},n.range=function(){return 1*(t.range||a.range())},n.paginationTemplate=function(){return t.paginationTemplate||a.paginationTemplate()},n.mapRows=function(t){return a.mapRows(t)},n.mapTotal=function(t){return a.mapTotal(t)}}],link:function(a,u,f,c){var $=e.defer(),g=c.paginationTemplate(),m=arguments;if(!1!==a.autostart&&(a.autostart=!0),a.mapRow||(a.mapRow=t.identity),$.promise.then(function(t){if(""!=t){var o=i(t)(a);u.append(o)}n.apply({$timeout:s,$document:l,$window:p},m)}),void 0!=g&&""!=g){var d=o.get(g);void 0!=d&&""!=d?$.resolve(d):r.get(g).then(function(t){$.resolve(t.data)},function(){$.resolve("")})}else $.resolve("")}}}]).directive("nbListScroll",["$window",function(t){return{restrict:"A",require:"nbList",priority:1,link:function(t,n,a){n.addClass("nb-list-scroll")}}}]).directive("nbListRow",[function(){return{restrict:"EA",link:function(t,n){n.addClass("nb-list-row")}}}]).directive("nbListCell",[function(){return{restrict:"EA",link:function(t,n){n.addClass("nb-list-cell")}}}])}(angular);