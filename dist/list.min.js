!function(t){"use strict";var n=function(n,i,a,e,o){var r=this;i.addClass("nb-list");var s={common:function(t){n.$count=n.$rows.length,n.$total=t,n.$more=n.$count<n.$total,n.$pages=Math.ceil(n.$total/e.limit()),n.$pageMin=1,n.$pageMax=n.$pages,n.$prev=n.$page>n.$pageMin,n.$next=n.$page<n.$pageMax;var i=n.$page-1;i<1&&(i=1);var a=n.$page+1;a>n.$pages&&(a=n.$pages),n.$prevPage=isNaN(i)?1:i,n.$nextPage=isNaN(a)?1:a,n.$pagination=n.$pages>1;for(var o=[],r=e.range(),s=[],l=n.$pageMin,u=n.$pageMax,p=1;p<=n.$pages;p++)o.push(p);n.$paginator=o,r>0&&((l=n.$page-r)<n.$pageMin&&(l=n.$pageMin),(u=n.$page+r)>n.$pageMax&&(u=n.$pageMax));for(p=l;p<=u;p++)s.push(p);n.$range=s,n.$pageMinInRange=n.$range.indexOf(n.$pageMin)>-1,n.$pageMaxInRange=n.$range.indexOf(n.$pageMax)>-1},init:function(i,a){var e=[];t.forEach(i,function(t){e.push(t)}),n.$rows=e,n.$page=1,s.common(a),n.$init=!0},more:function(a,e){var o=i.parents("md-content"),l=i.height();n.$page>n.$pageMin&&(n.$rows=[]),t.forEach(a,function(t){n.$rows.push(t)}),n.$page=n.$pageMin,s.common(e),r.$timeout(function(){o.first().animate({scrollTop:l-o.offset().top},500)},10)},page:function(i,a,e){var o=[];t.forEach(a,function(t){o.push(t)}),n.$rows=o,n.$page=i+1,s.common(e)}};o(n,function(t){i.prepend(t)}),n.$offset=e.offset(),n.$limit=e.limit(),n.$loading=!0,n.$init=!1,n.$rows=[],n.$paginator=[],s.common(0),n.$nbList={load:function(i){if(t.isArray(n.source))s.init(n.source,n.source.length),n.$loading=!1;else if(t.isFunction(n.source)){n.$loading=!0;var a=n.source({offset:i?0:e.offset(),limit:i||e.limit()});t.isArray(a)?(s.init(a,a.length),n.$loading=!1):a&&a.then(function(t){s.init(e.mapRows(t.data),e.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText)}).finally(function(){n.$loading=!1})}},refresh:function(){n.$page>1?this.page(n.$page):this.load(n.$count)},reset:function(){n.offset=0,n.offset=0,n.$nbList.load()},more:function(){n.$loading=!0;var i=e.offset()+e.limit();n.$page>n.$pageMin&&(i=0);var a=n.source({offset:i,limit:e.limit()});n.offset=i,n.offset=i,t.isArray(a)?(s.more(a,a.length),n.$loading=!1):a.then(function(t){s.more(e.mapRows(t.data),e.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText)}).finally(function(){n.$loading=!1})},page:function(i){n.$loading=!0;var a=i-1;a<0?a=0:a>=n.$pages&&(a=n.pages-1);var o=a*e.limit(),r=n.source({offset:o,limit:e.limit()});n.offset=o,n.offset=o,t.isArray(r)?(s.page(a,r,r.length),n.$loading=!1):r.then(function(t){s.page(a,e.mapRows(t.data),e.mapTotal(t.data))},function(t){console.log(t.status+" - "+t.statusText)}).finally(function(){n.$loading=!1})}},n.$nbList.load()};t.module("nb.list",[]).provider("$nbList",[function(){var t=this,n={limit:10,range:0,paginationTemplate:"",map:{rows:function(t){return t.rows},total:function(t){return t.total}}};t.limit=function(t){return n.limit=t,n.limit},t.range=function(t){return n.range=t,n.range},t.paginationTemplate=function(t){return n.paginationTemplate=t,n.paginationTemplate},t.mapRows=function(t){return n.map.rows=t,n.map.rows},t.mapTotal=function(t){return n.map.total=t,n.map.total},t.$get=[function(){var t=function(){};return t.limit=function(){return n.limit},t.range=function(){return n.range},t.paginationTemplate=function(){return n.paginationTemplate},t.mapRows=function(t){return n.map.rows.call(this,t)},t.mapTotal=function(t){return n.map.total.call(this,t)},t}]}]).directive("nbList",["$nbList","$compile","$templateCache","$q","$http","$timeout","$document","$window",function(t,i,a,e,o,r,s,l){return{restrict:"EA",transclude:!0,scope:{source:"=",offset:"@",limit:"@",range:"@",locals:"=",paginationTemplate:"@",$nbList:"=control"},controller:["$scope",function(n){var i=this;i.offset=function(){return 1*(n.offset||0)},i.limit=function(){return 1*(n.limit||t.limit())},i.range=function(){return 1*(n.range||t.range())},i.paginationTemplate=function(){return n.paginationTemplate||t.paginationTemplate()},i.mapRows=function(n){return t.mapRows(n)},i.mapTotal=function(n){return t.mapTotal(n)}}],link:function(t,u,p,f){var c=e.defer(),g=f.paginationTemplate(),$=arguments;if(c.promise.then(function(a){if(""!=a){var e=i(a)(t);u.append(e)}n.apply({$timeout:r,$document:s,$window:l},$)}),void 0!=g&&""!=g){var m=a.get(g);void 0!=m&&""!=m?c.resolve(m):o.get(g).then(function(t){c.resolve(t.data)},function(){c.resolve("")})}else c.resolve("")}}}]).directive("nbListScroll",["$window",function(t){return{restrict:"A",require:"nbList",priority:1,link:function(t,n,i){n.addClass("nb-list-scroll")}}}]).directive("nbListRow",[function(){return{restrict:"EA",link:function(t,n){n.addClass("nb-list-row")}}}]).directive("nbListCell",[function(){return{restrict:"EA",link:function(t,n){n.addClass("nb-list-cell")}}}])}(angular);