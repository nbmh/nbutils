!function(r){"use strict";r.module("nb.acl",["nb.auth"]).directive("nbAclIfAllowed",["ngIfDirective","$acl",function(r,i){var n=r[0];return{transclude:n.transclude,priority:n.priority,terminal:n.terminal,restrict:n.restrict,link:function(r,t,e,l,a){e.ngIf=function(){return i.isAllowed(e.nbAclIfAllowed)},n.link.call(n,r,t,e,l,a)}}}]).directive("nbAclShowAllowed",["$acl","$rootScope",function(r,i){return{restrict:"A",link:function(n,t,e){r.isAllowed(e.nbAclShowAllowed)?t.removeClass("acl-hide"):t.addClass("acl-hide"),i.$on("$acl.update.rights",function(){r.isAllowed(e.nbAclShowAllowed)?t.removeClass("acl-hide"):t.addClass("acl-hide")}),i.$on("$acl.update.groups",function(){r.isAllowed(e.nbAclShowAllowed)?t.removeClass("acl-hide"):t.addClass("acl-hide")})}}}]).directive("nbAclIfGroup",["ngIfDirective","$acl",function(r,i){var n=r[0];return{transclude:n.transclude,priority:n.priority,terminal:n.terminal,restrict:n.restrict,link:function(r,t,e,l,a){e.ngIf=function(){return i.isGroup(e.nbAclIfGroup)},n.link.call(n,r,t,e,l,a)}}}]).directive("nbAclShowGroup",["$acl","$rootScope",function(r,i){return{restrict:"A",link:function(n,t,e){r.isGroup(e.nbAclShowGroup)?t.removeClass("acl-hide"):t.addClass("acl-hide"),i.$on("$acl.update.groups",function(){r.isGroup(e.nbAclShowGroup)?t.removeClass("acl-hide"):t.addClass("acl-hide")})}}}]).provider("$acl",[function(){var i,n=this,t=[],e=[];n.setRights=function(r){e=r||[]},n.setGroups=function(r){t=r||[]},n.$get=["$rootScope","$state","$auth","$transitions",function(n,l,a,o){return i=function(r){return r?i.isAllowed(r):i.rights()},i.isAllowed=function(n){var t=i.rights(),e=[];r.isArray(n)?e=n:r.isString(n)&&(e=n.split("|"));var l=!1;return r.forEach(e,function(r){!l&&t.indexOf(r)>-1&&(l=!0)}),l},i.isGroup=function(n){var t=i.groups(),e=[],l=!1;return r.isArray(n)?e=n:r.isString(n)&&(e=n.split("|")),r.forEach(e,function(r){if(!l){var n=r,e=[];r.indexOf(":")>-1&&(n=r.substr(0,r.indexOf(":")),e=r.substr(r.indexOf(":")+1)),t.indexOf(n)>-1&&(l=!e.length||i.isAllowed(e.replace(/;/gi,"|").replace(/,/gi,"|")))}}),l},i.rights=function(i){return i&&r.isArray(i)&&(e=i||[],n.$emit("$acl.update.rights",e)),e||[]},i.groups=function(i){return i&&r.isArray(i)&&(t=i||[],n.$emit("$acl.update.groups",t)),t||[]},o.onStart({},function(n){var t=n.to();if(t.params.acl){var e=t.params.acl;if(r.isString(t.params.acl)&&(e=t.params.acl.split("|")),e.length&&!i.isAllowed(e)){n.abort();var o=a.getStateMain();l.go(o.name,o.params,o.options)}}}),i}]}])}(angular);