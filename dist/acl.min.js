!function(r){"use strict";r.module("nb.acl",["nb.auth"]).directive("nbAclIfAllowed",["ngIfDirective","$acl",function(r,i){var t=r[0];return{transclude:t.transclude,priority:t.priority,terminal:t.terminal,restrict:t.restrict,link:function(r,l,n,a,e){n.ngIf=function(){return i.isAllowed(n.nbAclIfAllowed)},t.link.call(t,r,l,n,a,e)}}}]).directive("nbAclShowAllowed",["$acl","$rootScope",function(r,i){return{restrict:"A",link:function(t,l,n){r.isAllowed(n.nbAclShowAllowed)?l.removeClass("acl-hide"):l.addClass("acl-hide"),i.$on("$acl.update.rights",function(){r.isAllowed(n.nbAclShowAllowed)?l.removeClass("acl-hide"):l.addClass("acl-hide")}),i.$on("$acl.update.groups",function(){r.isAllowed(n.nbAclShowAllowed)?l.removeClass("acl-hide"):l.addClass("acl-hide")})}}}]).directive("nbAclIfGroup",["ngIfDirective","$acl",function(r,i){var t=r[0];return{transclude:t.transclude,priority:t.priority,terminal:t.terminal,restrict:t.restrict,link:function(r,l,n,a,e){n.ngIf=function(){return i.isGroup(n.nbAclIfGroup)},t.link.call(t,r,l,n,a,e)}}}]).directive("nbAclShowGroup",["$acl","$rootScope",function(r,i){return{restrict:"A",link:function(t,l,n){r.isGroup(n.nbAclShowGroup)?l.removeClass("acl-hide"):l.addClass("acl-hide"),i.$on("$acl.update.groups",function(){r.isGroup(n.nbAclShowGroup)?l.removeClass("acl-hide"):l.addClass("acl-hide")})}}}]).provider("$acl",[function(){var i;this.$get=["$rootScope","$localStorage","$state","$auth","$transitions",function(t,l,n,a,e){return l.aclRights||(l.aclRights=[]),l.aclGroups||(l.aclGroups=[]),i=function(r){return r?i.isAllowed(r):i.rights()},i.isAllowed=function(t){var l=i.rights(),n=[];r.isArray(t)?n=t:r.isString(t)&&(n=t.split("|"));var a=!1;return r.forEach(n,function(r){!a&&l.indexOf(r)>-1&&(a=!0)}),a},i.isGroup=function(t){var l=i.groups(),n=[],a=!1;return r.isArray(t)?n=t:r.isString(t)&&(n=t.split("|")),r.forEach(n,function(r){if(!a){var t=r,n=[];r.indexOf(":")>-1&&(t=r.substr(0,r.indexOf(":")),n=r.substr(r.indexOf(":")+1)),l.indexOf(t)>-1&&(a=!n.length||i.isAllowed(n.replace(/;/gi,"|").replace(/,/gi,"|")))}}),a},i.rights=function(i){return i&&r.isArray(i)&&(l.aclRights=i||[],t.$emit("$acl.update.rights",l.aclRights)),l.aclRights||[]},i.groups=function(i){return i&&r.isArray(i)&&(l.aclGroups=i||[],t.$emit("$acl.update.groups",l.aclGroups)),l.aclGroups||[]},e.onStart({},function(t){var l=t.to();if(l.params.acl){var e=l.params.acl;if(r.isString(l.params.acl)&&(e=l.params.acl.split("|")),e.length&&!i.isAllowed(e)){t.abort();var o=a.getStateMain();n.go(o.name,o.params,o.options)}}}),i}]}])}(angular);